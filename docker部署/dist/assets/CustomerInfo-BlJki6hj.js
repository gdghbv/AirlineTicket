import{c as w,m as B,u as E}from"./customer-BTYy29KR.js";import{r as g,x as D,B as F,E as r,g as M,h as v,w as l,e as n,o as _,a as P,c as N,d as a,f as s,t as f,F as U}from"./index-DuoLJuUX.js";import"./request-DuNoOhOk.js";const $={key:1},j={__name:"CustomerInfo",setup(z){const t=g(null),u=g(!1),o=D({userName:"",email:""});F(()=>{w().then(i=>{t.value=i,console.log("后端返回的个人信息数据:",i)}).catch(()=>{r.error("获取个人信息失败")})}),M(u,i=>{i&&t.value&&(o.userName=t.value.userName,o.email=t.value.email)});function V(){B().then(()=>{r.success("会员注册成功"),t.value.milsPoints=0,u.value=!1}).catch(()=>{r.error("会员注册失败，请稍后再试")}),r.info("请前往会员注册页面或调用注册接口")}function k(){E({...t.value,userName:o.userName,email:o.email}).then(()=>{r.success("修改成功"),t.value.userName=o.userName,t.value.email=o.email,u.value=!1}).catch(()=>{r.error("修改失败")})}return(i,e)=>{const d=n("el-descriptions-item"),p=n("el-button"),y=n("el-descriptions"),c=n("el-input"),b=n("el-form-item"),x=n("el-form"),C=n("el-dialog"),I=n("el-card");return _(),v(I,null,{default:l(()=>[e[9]||(e[9]=P("h2",null,"个人信息",-1)),t.value?(_(),v(y,{key:0,column:1,border:""},{default:l(()=>[a(d,{label:"用户ID"},{default:l(()=>[s(f(t.value.customerId),1)]),_:1}),a(d,{label:"用户名"},{default:l(()=>[s(f(t.value.userName),1)]),_:1}),a(d,{label:"手机号"},{default:l(()=>[s(f(t.value.phone),1)]),_:1}),a(d,{label:"邮箱"},{default:l(()=>[s(f(t.value.email),1)]),_:1}),a(d,{label:"会员积分"},{default:l(()=>[t.value.milsPoints===-1?(_(),v(p,{key:0,type:"primary",size:"small",onClick:V},{default:l(()=>e[5]||(e[5]=[s("注册会员")])),_:1,__:[5]})):(_(),N(U,{key:1},[s(f(t.value.milsPoints),1)],64))]),_:1})]),_:1})):(_(),N("div",$,"加载中...")),a(p,{type:"primary",style:{"margin-top":"18px"},onClick:e[0]||(e[0]=m=>u.value=!0)},{default:l(()=>e[6]||(e[6]=[s("修改个人信息")])),_:1,__:[6]}),a(C,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=m=>u.value=m),title:"修改个人信息",width:"380px","close-on-click-modal":!1},{footer:l(()=>[a(p,{onClick:e[3]||(e[3]=m=>u.value=!1)},{default:l(()=>e[7]||(e[7]=[s("取消")])),_:1,__:[7]}),a(p,{type:"primary",onClick:k},{default:l(()=>e[8]||(e[8]=[s("保存")])),_:1,__:[8]})]),default:l(()=>[a(x,{model:o,"label-width":"80px"},{default:l(()=>[a(b,{label:"用户名"},{default:l(()=>[a(c,{modelValue:o.userName,"onUpdate:modelValue":e[1]||(e[1]=m=>o.userName=m),maxlength:"20"},null,8,["modelValue"])]),_:1}),a(b,{label:"邮箱"},{default:l(()=>[a(c,{modelValue:o.email,"onUpdate:modelValue":e[2]||(e[2]=m=>o.email=m),maxlength:"40"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1,__:[9]})}}};export{j as default};
