import{d as L,e as N}from"./customer-BTYy29KR.js";import{r as i,B,h as _,w as o,E as g,e as d,z as O,o as f,a as b,m as z,c as S,i as y,d as l,f as s,t as E}from"./index-DuoLJuUX.js";import"./request-DuNoOhOk.js";const I={key:0,style:{margin:"20px 0",color:"#888"}},U={__name:"CustomerOrderList",setup(T){const m=i([]),u=i(!1),r=i(!1),p=i(null),c=i(!1);function w(){u.value=!0,L({pageNum:1,pageSize:20}).then(n=>{m.value=Array.isArray(n.pageData)?n.pageData:[]}).catch(()=>{g.error("获取历史订单失败")}).finally(()=>{u.value=!1})}function k(n){p.value=n,r.value=!0}function C(){p.value&&(c.value=!0,N(p.value).then(()=>{g.success("退款成功"),r.value=!1,w()}).catch(()=>{g.error("退款失败")}).finally(()=>{c.value=!1}))}return B(w),(n,e)=>{const t=d("el-table-column"),v=d("el-button"),V=d("el-table"),D=d("el-dialog"),h=d("el-card"),x=O("loading");return f(),_(h,null,{default:o(()=>[e[7]||(e[7]=b("h2",null,"历史订单",-1)),z((f(),_(V,{data:m.value,style:{width:"100%"}},{default:o(()=>[l(t,{prop:"orderId",label:"订单号",width:"100"}),l(t,{prop:"airlineId",label:"航班号",width:"100"}),l(t,{prop:"seatType",label:"舱型",width:"80"}),l(t,{prop:"citizenName",label:"乘机人",width:"100"}),l(t,{prop:"spending",label:"消费金额",width:"100"}),l(t,{prop:"bookingTime",label:"下单时间",width:"180"}),l(t,{prop:"orderStat",label:"状态",width:"100"}),l(t,{label:"操作",width:"120"},{default:o(a=>[a.row.orderStat==="已支付"?(f(),_(v,{key:0,type:"danger",size:"small",onClick:A=>k(a.row)},{default:o(()=>e[2]||(e[2]=[s("退款")])),_:2,__:[2]},1032,["onClick"])):y("",!0)]),_:1})]),_:1},8,["data"])),[[x,u.value]]),m.value.length===0&&!u.value?(f(),S("div",I,"暂无历史订单")):y("",!0),l(D,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=a=>r.value=a),title:"确认退款",width:"340px","close-on-click-modal":!1},{footer:o(()=>[l(v,{onClick:e[0]||(e[0]=a=>r.value=!1)},{default:o(()=>e[5]||(e[5]=[s("取消")])),_:1,__:[5]}),l(v,{type:"primary",onClick:C,loading:c.value},{default:o(()=>e[6]||(e[6]=[s("确定")])),_:1,__:[6]},8,["loading"])]),default:o(()=>{var a;return[b("div",null,[e[3]||(e[3]=s("确定要对订单号 ")),b("b",null,E((a=p.value)==null?void 0:a.orderId),1),e[4]||(e[4]=s(" 进行退款吗？"))])]}),_:1},8,["modelValue"])]),_:1,__:[7]})}}};export{U as default};
