import{_ as q,r as g,x as T,B as M,e as o,z as P,c as C,o as V,d as e,w as l,m as H,i as Q,a as y,f as i,t as h,l as B,I as J,E as v,h as W,J as X,H as Y,K as Z}from"./index-DuoLJuUX.js";import{g as K,n as L,o as ee,p as le}from"./airport-DZ6oIf4n.js";import"./request-DuNoOhOk.js";const ae={class:"airport-user"},te={class:"user-info-content"},re={key:0,class:"info-section"},oe={class:"action-section"},se={class:"dialog-footer"},ne={__name:"AirportUser",setup(z){const p=g(!1),r=g(null),s=g(!1),m=g(null),u=T({airportUserId:null,userName:"",email:""}),c={userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"用户名长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:["blur","change"]}]},x=async()=>{try{p.value=!0;const d=await K();Array.isArray(d)&&d.length>0?r.value=d[0]:d&&Array.isArray(d.data)&&d.data.length>0?r.value=d.data[0]:r.value=null,console.log("获取用户信息成功:",r.value)}catch(d){console.error("获取用户信息失败:",d),v.error("获取用户信息失败")}finally{p.value=!1}},w=()=>{r.value&&(u.airportUserId=r.value.airportUserId,u.userName=r.value.userName||"",u.email=r.value.email||"",s.value=!0)},D=()=>{m.value.validate(async d=>{if(d)try{await L(u),v.success("修改成功"),s.value=!1,x()}catch(n){console.error("修改失败:",n),v.error("修改失败")}})},A=()=>{s.value=!1,m.value&&m.value.clearValidate()};return M(()=>{x()}),(d,n)=>{const b=o("el-descriptions-item"),k=o("el-descriptions"),$=o("el-icon"),a=o("el-button"),t=o("el-card"),N=o("el-input"),U=o("el-form-item"),f=o("el-form"),F=o("el-dialog"),E=P("loading");return V(),C("div",ae,[e(t,{class:"user-info-card",shadow:"never"},{header:l(()=>n[2]||(n[2]=[y("div",{class:"card-header"},[y("span",null,"个人信息")],-1)])),default:l(()=>[H((V(),C("div",te,[r.value?(V(),C("div",re,[e(k,{column:2,size:"large",border:""},{default:l(()=>[e(b,{label:"用户ID"},{default:l(()=>[i(h(r.value.userId),1)]),_:1}),e(b,{label:"机场ID"},{default:l(()=>[i(h(r.value.airportId),1)]),_:1}),e(b,{label:"机场名称"},{default:l(()=>[i(h(r.value.airportName),1)]),_:1}),e(b,{label:"用户名"},{default:l(()=>[i(h(r.value.userName||"未设置"),1)]),_:1}),e(b,{label:"机场电话"},{default:l(()=>[i(h(r.value.airportPhone),1)]),_:1}),e(b,{label:"电话"},{default:l(()=>[i(h(r.value.phone),1)]),_:1}),e(b,{label:"地址",span:2},{default:l(()=>[i(h(r.value.address),1)]),_:1})]),_:1})])):Q("",!0),y("div",oe,[e(a,{type:"primary",onClick:w},{default:l(()=>[e($,null,{default:l(()=>[e(B(J))]),_:1}),n[3]||(n[3]=i(" 修改个人信息 "))]),_:1,__:[3]})])])),[[E,p.value]])]),_:1}),e(F,{title:"修改个人信息",modelValue:s.value,"onUpdate:modelValue":n[1]||(n[1]=I=>s.value=I),width:"500px","before-close":A},{footer:l(()=>[y("span",se,[e(a,{onClick:A},{default:l(()=>n[4]||(n[4]=[i("取消")])),_:1,__:[4]}),e(a,{type:"primary",onClick:D},{default:l(()=>n[5]||(n[5]=[i("保存")])),_:1,__:[5]})])]),default:l(()=>[e(f,{model:u,rules:c,ref_key:"editFormRef",ref:m,"label-width":"80px"},{default:l(()=>[e(U,{label:"用户名",prop:"userName"},{default:l(()=>[e(N,{modelValue:u.userName,"onUpdate:modelValue":n[0]||(n[0]=I=>u.userName=I),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ie=q(ne,[["__scopeId","data-v-842302cb"]]),de={class:"airport-user-all"},ue={class:"card-header"},ce={class:"dialog-footer"},me={__name:"AirportUserAll",setup(z){const p=g(!1),r=g([]),s=g(!1),m=g(null),u=g(null),c=T({airportUserId:null,userName:"",email:""}),x={userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"用户名长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:["blur","change"]}]},w=async()=>{try{p.value=!0;const a=await ee();r.value=a}catch(a){console.error("获取用户列表失败:",a),v.error("获取用户列表失败")}finally{p.value=!1}},D=async()=>{try{const a=await K();u.value=a.airportUserId}catch(a){console.error("获取当前用户信息失败:",a)}},A=a=>{c.airportUserId=a.airportUserId,c.userName=a.userName||"",c.email=a.email||"",s.value=!0},d=a=>{if(a.airportUserId===u.value){v.warning("不能删除自己的账号");return}Z.confirm(`确定要删除用户 "${a.userName||a.email}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{n(a.airportUserId)}).catch(()=>{v.info("已取消删除")})},n=async a=>{try{await le(a),v.success("删除成功"),w()}catch(t){console.error("删除用户失败:",t),v.error("删除失败")}},b=()=>{m.value.validate(async a=>{if(a)try{await L(c),v.success("修改成功"),s.value=!1,w()}catch(t){console.error("修改失败:",t),v.error("修改失败")}})},k=()=>{s.value=!1,m.value&&m.value.clearValidate()},$=()=>{w()};return M(()=>{D(),w()}),(a,t)=>{const N=o("el-icon"),U=o("el-button"),f=o("el-table-column"),F=o("el-table"),E=o("el-card"),I=o("el-input"),R=o("el-form-item"),S=o("el-form"),j=o("el-dialog"),G=P("loading");return V(),C("div",de,[e(E,{class:"user-list-card",shadow:"never"},{header:l(()=>[y("div",ue,[t[4]||(t[4]=y("span",null,"所有机场用户",-1)),e(U,{type:"primary",onClick:$},{default:l(()=>[e(N,null,{default:l(()=>[e(B(Y))]),_:1}),t[3]||(t[3]=i(" 刷新 "))]),_:1,__:[3]})])]),default:l(()=>[H((V(),W(F,{data:r.value,style:{width:"100%"},stripe:"",height:"100%"},{default:l(()=>[e(f,{prop:"userId",label:"用户ID",width:"80"}),e(f,{prop:"airportId",label:"机场ID",width:"80"}),e(f,{prop:"airportName",label:"机场名称",width:"200"}),e(f,{prop:"userName",label:"用户名",width:"120"},{default:l(_=>[i(h(_.row.userName||"未设置"),1)]),_:1}),e(f,{prop:"airportPhone",label:"机场电话",width:"200"}),e(f,{prop:"phone",label:"电话",width:"120"}),e(f,{prop:"address",label:"地址","min-width":"200"}),e(f,{label:"操作",width:"180",fixed:"right"},{default:l(_=>[e(U,{size:"small",onClick:O=>A(_.row)},{default:l(()=>[e(N,null,{default:l(()=>[e(B(J))]),_:1}),t[5]||(t[5]=i(" 编辑 "))]),_:2,__:[5]},1032,["onClick"]),e(U,{size:"small",type:"danger",onClick:O=>d(_.row),disabled:_.row.airportUserId===u.value},{default:l(()=>[e(N,null,{default:l(()=>[e(B(X))]),_:1}),t[6]||(t[6]=i(" 删除 "))]),_:2,__:[6]},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[G,p.value]])]),_:1}),e(j,{title:"编辑用户信息",modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=_=>s.value=_),width:"500px","before-close":k},{footer:l(()=>[y("span",ce,[e(U,{onClick:k},{default:l(()=>t[7]||(t[7]=[i("取消")])),_:1,__:[7]}),e(U,{type:"primary",onClick:b},{default:l(()=>t[8]||(t[8]=[i("保存")])),_:1,__:[8]})])]),default:l(()=>[e(S,{model:c,rules:x,ref_key:"editFormRef",ref:m,"label-width":"80px"},{default:l(()=>[e(R,{label:"用户名",prop:"userName"},{default:l(()=>[e(I,{modelValue:c.userName,"onUpdate:modelValue":t[0]||(t[0]=_=>c.userName=_),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(R,{label:"邮箱",prop:"email"},{default:l(()=>[e(I,{modelValue:c.email,"onUpdate:modelValue":t[1]||(t[1]=_=>c.email=_),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},_e=q(me,[["__scopeId","data-v-a77f3639"]]),pe={class:"airport-center"},fe={__name:"AirportCenterView",setup(z){const p=g("personal");return(r,s)=>{const m=o("el-tab-pane"),u=o("el-tabs");return V(),C("div",pe,[s[1]||(s[1]=y("div",{class:"page-header"},[y("h2",null,"用户管理")],-1)),e(u,{modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=c=>p.value=c),class:"center-tabs"},{default:l(()=>[e(m,{label:"个人信息",name:"personal"},{default:l(()=>[e(ie)]),_:1}),e(m,{label:"所有用户",name:"all"},{default:l(()=>[e(_e)]),_:1})]),_:1},8,["modelValue"])])}}},ye=q(fe,[["__scopeId","data-v-e3f13c70"]]);export{ye as default};
